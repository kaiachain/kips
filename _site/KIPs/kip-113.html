<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
    <title>KIP 113: BLS public key registry</title>
    <meta property="og:title" content="KIP 113: BLS public key registry" />
    <meta
      name="description"
      content="Details on Kaia Improvement Proposal 113 (KIP 113): BLS public key registry"
    />
    <meta
      property="og:description"
      content="Details on Kaia Improvement Proposal 113 (KIP 113): BLS public key registry"
    />
    <meta name="twitter:description" content="Details on Kaia Improvement Proposal 113 (KIP 113): BLS public key registry" />
  
  <meta name="generator" content="Jekyll" />
  <meta property="og:locale" content="en_US" />
  <link rel="canonical" href="http://localhost:4000/KIPs/kip-113" />
  <meta property="og:url" content="http://localhost:4000/KIPs/kip-113" />
  <meta property="og:site_name" content="Kaia Improvement Proposals" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@kaiachain" />
  <script type="application/ld+json">
    {
      "@type": "WebSite",
      "url": "http://localhost:4000",
      "name": "Kaia Improvement Proposals",
      "description": "Kaia Improvement Proposals (KIPs) describe standards for the Kaia platform, including core protocol specifications, client APIs, and contract standards.",
      "@context": "https://schema.org"
    }
  </script>
  <link rel="stylesheet" href="/assets/css/style.css" /><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Kaia Improvement Proposals" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Kaia Improvement Proposals</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/all">All</a><a class="page-link" href="/core">Core</a><a class="page-link" href="/networking">Networking</a><a class="page-link" href="/storage">Storage</a><a class="page-link" href="/interface">Interface</a><a class="page-link" href="/token">KCT</a><a class="page-link" href="/sdk">SDK</a><a class="page-link" href="/application">Application</a><a class="page-link" href="/meta">Meta</a><a class="page-link" href="/informational">Informational</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="home">
  <h1 class="page-heading">
    KIP 113: BLS public key registry
    <a href="https://github.com/kaiachain/KIPS/blob/main/KIPs/kip-113.md"><svg role="img" aria-label="Source" xmlns="https://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><title>Source</title><path fill-rule="evenodd" d="M9.5 3L8 4.5 11.5 8 8 11.5 9.5 13 14 8 9.5 3zm-5 0L0 8l4.5 5L6 11.5 2.5 8 6 4.5 4.5 3z"/></svg></a>
  </h1>
  <table>
    <tr><th>Author</th><td><a href="https://github.com/ian0371">Ian</a>, <a href="https://github.com/blukat29">Ollie</a>, <a href="https://github.com/jiseongnoh">Joseph</a>, <a href="https://github.com/aidan-kwon">and Aidan</a></td></tr>
    
      <tr><th>Discussions-To</th><td><a href="https://github.com/klaytn/kips/issues/113">https://github.com/klaytn/kips/issues/113</a></td></tr>
    
    <tr><th>Status</th><td>Draft
    
    </td></tr>
    <tr><th>Type</th><td>Standards Track</td></tr>
    
      <tr><th>Category</th><td>Core</td></tr>
    
    <tr><th>Created</th><td>2023-05-22</td></tr>
    
    
    
    
    
  </table>

  <h2 id="simple-summary">Simple Summary</h2>

<p>A design of simple BLS12-381 registry.</p>

<h2 id="abstract">Abstract</h2>

<p>This standard defines an interface for BLS12-381 registry, which enables nodes or smart contracts to access and view all the public keys of the associated addresses.</p>

<h2 id="motivation">Motivation</h2>

<p>A standard interface allows developers to associate an address with a BLS public key. The objective is to design a simple registry interface, enabling Klaytn nodes to read BLS keys, each of which is associated with a node ID.</p>

<h2 id="specification">Specification</h2>

<p>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL” in this document are to be interpreted as described in RFC 2119.</p>

<p>Registry contract must implement the IKIP113 interface:</p>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">pragma</span> <span class="n">solidity</span> <span class="o">^</span><span class="mf">0.8</span><span class="p">.</span><span class="mi">19</span><span class="p">;</span>

<span class="c1">/// @title KIP-113 BLS public key registry
/// @dev See https://github.com/klaytn/kips/issues/113
</span><span class="k">interface</span> <span class="n">IKIP113</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">BlsPublicKeyInfo</span> <span class="p">{</span>
        <span class="c1">/// @dev compressed BLS12-381 public key (48 bytes)
</span>        <span class="kt">bytes</span> <span class="n">publicKey</span><span class="p">;</span>
        <span class="c1">/// @dev proof-of-possession (96 bytes)
</span>        <span class="c1">///  must be a result of PopProve algorithm as per
</span>        <span class="c1">///  draft-irtf-cfrg-bls-signature-05 section 3.3.3.
</span>        <span class="c1">///  with ciphersuite "BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_POP_"
</span>        <span class="kt">bytes</span> <span class="n">pop</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">/// @dev Returns all the stored addresses, public keys, and proof-of-possessions at once.
</span>    <span class="c1">///  _Note_ The function is not able to verify the validity of the public key and the proof-of-possession due to the lack of [EIP-2537](https://eips.ethereum.org/EIPS/eip-2537). See [validation](https://kips.klaytn.foundation/KIPs/kip-113#validation) for off-chain validation.
</span>    <span class="k">function</span> <span class="n">getAllBlsInfo</span><span class="p">()</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">address</span><span class="p">[]</span> <span class="k">memory</span> <span class="n">nodeIdList</span><span class="p">,</span> <span class="n">BlsPublicKeyInfo</span><span class="p">[]</span> <span class="k">memory</span> <span class="n">pubkeyList</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="definitions">Definitions</h3>

<p>The terms public key and proof-of-possession (hereinafter referred to as pop) are from the ciphersuite <a href="https://www.ietf.org/archive/id/draft-irtf-cfrg-bls-signature-05.html#section-4.2.3">BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_POP_</a>. Things to note:</p>

<ul>
  <li>Public key: 48 bytes.</li>
  <li>Proof-of-possession (pop): 96 bytes.</li>
</ul>

<h3 id="smart-contracts-overview">Smart Contracts Overview</h3>

<p>The proposed smart contract must be implemented in Solidity and must be compatible with the Ethereum Virtual Machine (EVM).</p>

<p>The smart contract must have the following features:</p>

<ul>
  <li>View the registered public keys</li>
</ul>

<h4 id="methods">Methods</h4>

<h5 id="getallblsinfo">getAllBlsInfo</h5>

<p>Returns all the stored addresses, public keys, and proof-of-possessions at once.</p>

<p><em>Note</em> The contract is not able to verify the validity of the public key and the proof-of-possession due to the lack of <a href="https://eips.ethereum.org/EIPS/eip-2537">EIP-2537</a>. See <a href="#validation">validation</a> for off-chain validation.</p>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span> <span class="n">getAllBlsInfo</span><span class="p">()</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">address</span><span class="p">[]</span> <span class="n">nodeIdList</span><span class="p">,</span> <span class="n">BlsPublicKeyInfo</span><span class="p">[]</span> <span class="n">pubkeyList</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="validation">Validation</h4>

<p>After reading from IKIP113, users must perform the following validations:</p>

<ul>
  <li><a href="https://www.ietf.org/archive/id/draft-irtf-cfrg-bls-signature-05.html#section-2.5">KeyValidate</a></li>
  <li><a href="https://www.ietf.org/archive/id/draft-irtf-cfrg-bls-signature-05.html#section-3.3.3">PopVerify</a></li>
</ul>

<h3 id="json-rpc-api">JSON-RPC API</h3>

<p>The following JSON-RPC method for the Klaytn node should be added to provide the registered BLS public keys.</p>

<ul>
  <li>Name: <code class="language-plaintext highlighter-rouge">klay_getBlsInfos</code></li>
  <li>Description: Returns all registered BLS public keys and proof-of-possessions of the validators.</li>
  <li>Parameters:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">number</code> - (optional) integer or hexadecimal block number, or the string “pending” or “latest”.</li>
    </ul>
  </li>
  <li>Returns: A map of the addresses and their associated BLS public keys, proof-of-possessions and verify error.
    <ul>
      <li><code class="language-plaintext highlighter-rouge">publicKey</code> - The compressed BLS12-381 public key in hex string.</li>
      <li><code class="language-plaintext highlighter-rouge">pop</code> - The proof-of-possession in hex string.</li>
      <li><code class="language-plaintext highlighter-rouge">verifyErr</code> - The error message of the verification. If the verification is successful, it returns null.</li>
    </ul>
  </li>
  <li>Example
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  // Request
  curl -X POST -H "Content-Type: application/json" --data '{"jsonrpc":"2.0", "method":"klay_getBlsInfos", "params":["latest"],"id":1}' http://localhost:8551
  // Response
  {
      "jsonrpc":"2.0",
      "id":1,
      "result":{
          "0x18a80d0d3a8b7348277c497105cc2163b242799a":{
              "publicKey":"8247754efd7aa2b02b30b6db8e1c24bb8c4207f5600470c2dafde1b46270a6c8c3fe9e7f8b939965d6a59dbe2ebd0cf7",
              "pop":"8c35987399eab7a98ad24e869a7d7225bdb95203167e6aa20b3db73c0a91317e805e48d33c606484b1e9db3d8c8d64b60f0c6a8816b219f43747bf201dd65193ade23434270c78441e370a95d7632a6a76f1f3a62842425f76ebc4a041fc1dbb",
              "verifyErr":null
          },
          "0x527d6d61f53305c1e1d3680b23393c3c13c8db9e":{
              "publicKey":"a16153b81453a9e3099728ff1d3aac3d3fca32b3594407277ec0b8df4aa66cba743916d9f2098707aecc350954b0cd4e",
              "pop":"a92c7ba586a12a38e3a7bbfed7f7a311664cb0dc66a7bd26ee79bed4755e7652850dff1cfabf39acd58ea8efe24ff7c217f1d5c2ac3fe948016056e99b03bc26aa8c59b89cfc9ee961bf8cfd1802295d4ff07852f93d0607a53655f15665aad9",
              "verifyErr":null
          },
          "0xa72ccdf72dc401df79805013a42b74f12b43caa1":{
              "publicKey":"883eb2c623a19671461bc0dadcfa17384198ff06b2e2c9cd1ca539ff554c377256624e9f5f69d27e17e4635080938d9a",
              "pop":"ac1bb19588b2ec7e1452486b8a4afe0ecb27847bca04b7e4919a9d6b70c1342dcfb1a6983788d3756607b84d3d7a009118246ed5b3b3449638e591ab9fe2c4ec5cafb64ddc12a5dcf48cbcf305175d5dddb48845e80f7cb9a32d5f2e67ca2163",
              "verifyErr":null
          }
      }
  }
</code></pre></div>    </div>
    <h2 id="backwards-compatibility">Backwards Compatibility</h2>
  </li>
</ul>

<p>This does not affect the backward compatibility as this is a newly deployed contract.</p>

<h2 id="copyright">Copyright</h2>

<p>Copyright and related rights waived via <a href="https://creativecommons.org/publicdomain/zero/1.0/">CC0</a>.</p>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.2.3/mermaid.min.js" integrity="sha512-M4zmdILgXOwrBEVfpVqdO/jC3BJZQzlXHeu967v41/QoT60sESWSLbi7YwntTbYC0ZjewfTbvXO8iKj7amvQow==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>
  mermaid.initialize({
    startOnLoad: true,
  });
  mermaid.run({
    querySelector: '.language-mermaid', // markdown 'mermaid' language code blocks
  });
</script>


</div>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Kaia Improvement Proposals</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Kaia Improvement Proposals</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/kaiachain/KIPs"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">kaiachain/KIPs</span></a></li><li><a href="https://twitter.com/kaiachain"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">kaiachain</span></a></li><li><a href="https://www.facebook.com/kaiachain"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#facebook"></use></svg> <span class="username">kaiachain</span></a></li><li><a href="https://medium.com/kaiachain"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#medium"></use></svg> <span class="username">kaiachain</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Kaia Improvement Proposals (KIPs) describe standards for the Kaia platform, including core protocol specifications, client APIs, and contract standards.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
