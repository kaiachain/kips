<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
    <title>KIP 13: Interface Query Standard</title>
    <meta property="og:title" content="KIP 13: Interface Query Standard" />
    <meta
      name="description"
      content="Details on Kaia Improvement Proposal 13 (KIP 13): Interface Query Standard"
    />
    <meta
      property="og:description"
      content="Details on Kaia Improvement Proposal 13 (KIP 13): Interface Query Standard"
    />
    <meta name="twitter:description" content="Details on Kaia Improvement Proposal 13 (KIP 13): Interface Query Standard" />
  
  <meta name="generator" content="Jekyll" />
  <meta property="og:locale" content="en_US" />
  <link rel="canonical" href="http://localhost:4000/KIPs/kip-13" />
  <meta property="og:url" content="http://localhost:4000/KIPs/kip-13" />
  <meta property="og:site_name" content="Kaia Improvement Proposals" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@kaiachain" />
  <script type="application/ld+json">
    {
      "@type": "WebSite",
      "url": "http://localhost:4000",
      "name": "Kaia Improvement Proposals",
      "description": "Kaia Improvement Proposals (KIPs) describe standards for the Kaia platform, including core protocol specifications, client APIs, and contract standards.",
      "@context": "https://schema.org"
    }
  </script>
  <link rel="stylesheet" href="/assets/css/style.css" /><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Kaia Improvement Proposals" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Kaia Improvement Proposals</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/all">All</a><a class="page-link" href="/core">Core</a><a class="page-link" href="/networking">Networking</a><a class="page-link" href="/storage">Storage</a><a class="page-link" href="/interface">Interface</a><a class="page-link" href="/token">KCT</a><a class="page-link" href="/sdk">SDK</a><a class="page-link" href="/application">Application</a><a class="page-link" href="/meta">Meta</a><a class="page-link" href="/informational">Informational</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="home">
  <h1 class="page-heading">
    KIP 13: Interface Query Standard
    <a href="https://github.com/kaiachain/KIPS/blob/main/KIPs/kip-13.md"><svg role="img" aria-label="Source" xmlns="https://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><title>Source</title><path fill-rule="evenodd" d="M9.5 3L8 4.5 11.5 8 8 11.5 9.5 13 14 8 9.5 3zm-5 0L0 8l4.5 5L6 11.5 2.5 8 6 4.5 4.5 3z"/></svg></a>
  </h1>
  <table>
    <tr><th>Author</th><td><a href="mailto:colin.kim@groundx.xyz">Junghyun Colin Kim</a></td></tr>
    
      <tr><th>Discussions-To</th><td><a href="https://github.com/klaytn/kips/issues/14">https://github.com/klaytn/kips/issues/14</a></td></tr>
    
    <tr><th>Status</th><td>Final
    
    </td></tr>
    <tr><th>Type</th><td>Standards Track</td></tr>
    
      <tr><th>Category</th><td>Interface</td></tr>
    
    <tr><th>Created</th><td>2020-02-27</td></tr>
    
    
    
    
    
  </table>

  <!--You can leave these HTML comments in your merged KIP and delete the visible duplicate text guides, they will not appear and may be helpful to refer to if you edit it again. This is the suggested template for new KIPs. Note that a KIP number will be assigned by an editor. When opening a pull request to submit your KIP, please use an abbreviated title in the filename, `kip-draft_title_abbrev.md`. The title should be 44 characters or less.-->

<h2 id="simple-summary">Simple Summary</h2>
<!--"If you can't explain it simply, you don't understand it well enough." Provide a simplified and layman-accessible explanation of the KIP.-->
<p>This KIP defines a method to query whether a contract implements a certain interface or not.</p>

<h2 id="abstract">Abstract</h2>
<!--A short (~200 word) description of the technical issue being addressed.-->
<p>This proposal defines:</p>
<ol>
  <li><a href="#how-interface-identifiers-are-defined">How interface identifiers are defined</a></li>
  <li><a href="#how-a-contract-publishes-the-interfaces-it-implements">How a contract publishes the interfaces it implements</a></li>
  <li><a href="#how-to-query-if-a-contract-implements-kip-13">How to query if a contract implements KIP-13</a></li>
  <li><a href="#how-to-query-if-a-contract-implements-any-given-interface">How to query if a contract implements any given interface</a></li>
</ol>

<h2 id="motivation">Motivation</h2>
<!--The motivation is critical for KIPs that want to change the Klaytn protocol. It should clearly explain why the existing protocol specification is inadequate to address the problem that the KIP solves. KIP submissions without sufficient motivation may be rejected outright.-->
<p>Since there is no clear way to find what functions are implemented in a contract, this KIP proposes a standard method to define and query interfaces in a contract.
For example, if we define an interface identifier of <a href="https://kips.klaytn.com/KIPs/kip-7">KIP-7</a>, we can easily determine a contract implements <a href="https://kips.klaytn.com/KIPs/kip-7">KIP-7</a> or not.</p>

<h2 id="specification">Specification</h2>
<p>This document derived heavily from Ethereum’s <a href="https://eips.ethereum.org/EIPS/eip-165">ERC-165</a> written by Christian Reitwießner, Nick Johnson, Fabian Vogelsteller, Jordi Baylina, Konrad Feldmeier, and William Entriken.</p>

<h3 id="how-interface-identifiers-are-defined">How Interface Identifiers are Defined</h3>

<p>An <em>interface identifier</em> is a combination of function selectors of a contract.
A function selector is four bytes of keccak256 hash of the signature of a function
(e.g., <code class="language-plaintext highlighter-rouge">bytes4(keccak256('supportsInterface(bytes4)'))</code>).
The signature is defined as the canonical expression of the basic prototype without parameter names and the return type.</p>

<p>We define the interface identifier as the XOR of all function selectors in the interface. This code example below shows how to calculate an interface identifier:</p>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">pragma</span> <span class="n">solidity</span> <span class="o">^</span><span class="mf">0.4</span><span class="p">.</span><span class="mi">24</span><span class="p">;</span>

<span class="k">interface</span> <span class="n">Solidity101</span> <span class="p">{</span>
    <span class="k">function</span> <span class="n">hello</span><span class="p">()</span> <span class="k">external</span> <span class="k">pure</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">world</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="k">external</span> <span class="k">pure</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">contract</span> <span class="n">Selector</span> <span class="p">{</span>
    <span class="k">function</span> <span class="n">calculateSelector</span><span class="p">()</span> <span class="k">public</span> <span class="k">pure</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bytes4</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Solidity101</span> <span class="n">i</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">i</span><span class="p">.</span><span class="n">hello</span><span class="p">.</span><span class="nb">selector</span> <span class="o">^</span> <span class="n">i</span><span class="p">.</span><span class="n">world</span><span class="p">.</span><span class="nb">selector</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Note: interfaces do not permit optional functions, therefore, the interface identifier will not include them.</p>

<h3 id="how-a-contract-publishes-the-interfaces-it-implements">How a Contract Publishes the Interfaces it Implements</h3>

<p>A contract that is compliant with KIP-13 shall implement the following interface (referred as <code class="language-plaintext highlighter-rouge">InterfaceIdentifier.sol</code>):</p>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">pragma</span> <span class="n">solidity</span> <span class="o">^</span><span class="mf">0.4</span><span class="p">.</span><span class="mi">24</span><span class="p">;</span>

<span class="k">interface</span> <span class="n">InterfaceIdentifier</span> <span class="p">{</span>
    <span class="c1">/// @notice Query if a contract implements an interface
</span>    <span class="c1">/// @param interfaceID The interface identifier, as defined in KIP-13.
</span>    <span class="c1">/// @dev Interface identifier is defined in KIP-13. This function
</span>    <span class="c1">///  uses less than 30,000 gas.
</span>    <span class="c1">/// @return `true` if the contract implements `interfaceID` and
</span>    <span class="c1">///  `interfaceID` is not 0xffffffff, `false` otherwise.
</span>    <span class="k">function</span> <span class="n">supportsInterface</span><span class="p">(</span><span class="kt">bytes4</span> <span class="n">interfaceID</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The interface identifier for this interface is <code class="language-plaintext highlighter-rouge">0x01ffc9a7</code>.
You can calculate this by running <code class="language-plaintext highlighter-rouge">bytes4(keccak256('supportsInterface(bytes4)'));</code> or using the <code class="language-plaintext highlighter-rouge">Selector</code> contract above.</p>

<p>The implementing contract will have a <code class="language-plaintext highlighter-rouge">supportsInterface</code> function, and it returns:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">true</code> when <code class="language-plaintext highlighter-rouge">interfaceID</code> is <code class="language-plaintext highlighter-rouge">0x01ffc9a7</code> (<code class="language-plaintext highlighter-rouge">supportsInterface</code> itself)</li>
  <li><code class="language-plaintext highlighter-rouge">false</code> when <code class="language-plaintext highlighter-rouge">interfaceID</code> is <code class="language-plaintext highlighter-rouge">0xffffffff</code></li>
  <li><code class="language-plaintext highlighter-rouge">true</code> for <code class="language-plaintext highlighter-rouge">interfaceID</code> this contract implements</li>
  <li><code class="language-plaintext highlighter-rouge">false</code> for any other <code class="language-plaintext highlighter-rouge">interfaceID</code></li>
</ul>

<p>This function must return a bool and use at most 30,000 gas.</p>

<p>Implementation note: there are several logical ways to implement this function. Please see the example implementations and the discussion on gas usage.</p>

<h3 id="how-to-query-if-a-contract-implements-kip-13">How to Query if a Contract Implements KIP-13</h3>

<ol>
  <li>The source contract makes a <code class="language-plaintext highlighter-rouge">STATICCALL</code> to the destination address with input data: <code class="language-plaintext highlighter-rouge">0x01ffc9a701ffc9a700000000000000000000000000000000000000000000000000000000</code> and gas 30,000. This corresponds to <code class="language-plaintext highlighter-rouge">contract.supportsInterface(0x01ffc9a7)</code>.</li>
  <li>If the call fails or return false, the destination contract does not implement KIP-13.</li>
  <li>If the call returns true, a second call is made with input data <code class="language-plaintext highlighter-rouge">0x01ffc9a7ffffffff00000000000000000000000000000000000000000000000000000000</code>.
  This corresponds to <code class="language-plaintext highlighter-rouge">contract.supportsInterface(0xffffffff)</code>.</li>
  <li>If the second call fails or returns true, the destination contract does not implement KIP-13.</li>
  <li>Otherwise it implements KIP-13.</li>
</ol>

<h3 id="how-to-query-if-a-contract-implements-any-given-interface">How to Query if a Contract Implements any Given Interface</h3>

<ol>
  <li>If you are not sure if the contract implements KIP-13, use the above procedure to confirm.</li>
  <li>If it does not implement KIP-13, then you will have to see what methods it uses in other way.</li>
  <li>If it implements KIP-13 then just call <code class="language-plaintext highlighter-rouge">supportsInterface(interfaceID)</code> to determine if it implements an interface you can use.</li>
</ol>

<h2 id="rationale">Rationale</h2>

<p>We tried to keep this specification as simple as possible. This implementation is also compatible with the current Solidity version.</p>

<h2 id="backwards-compatibility">Backwards Compatibility</h2>

<p>The mechanism described above (with <code class="language-plaintext highlighter-rouge">0xffffffff</code>) should work with most of the contracts previous to this standard to determine that they do not implement KIP-13.</p>

<h2 id="test-cases">Test Cases</h2>

<p>Following is a contract that detects which interfaces other contracts implement. From @fulldecent and @jbaylina.</p>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">pragma</span> <span class="n">solidity</span> <span class="o">^</span><span class="mf">0.4</span><span class="p">.</span><span class="mi">24</span><span class="p">;</span>

<span class="k">contract</span> <span class="n">supportsInterfaceQuery</span> <span class="p">{</span>
    <span class="kt">bytes4</span> <span class="k">constant</span> <span class="n">InvalidID</span> <span class="o">=</span> <span class="mh">0xffffffff</span><span class="p">;</span>
    <span class="kt">bytes4</span> <span class="k">constant</span> <span class="n">supportsInterfaceID</span> <span class="o">=</span> <span class="mh">0x01ffc9a7</span><span class="p">;</span>

    <span class="k">function</span> <span class="n">doesContractImplementInterface</span><span class="p">(</span><span class="kt">address</span> <span class="n">_contract</span><span class="p">,</span> <span class="kt">bytes4</span> <span class="n">_interfaceId</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">uint256</span> <span class="n">success</span><span class="p">;</span>
        <span class="kt">uint256</span> <span class="n">result</span><span class="p">;</span>

        <span class="p">(</span><span class="n">success</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span> <span class="o">=</span> <span class="n">noThrowCall</span><span class="p">(</span><span class="n">_contract</span><span class="p">,</span> <span class="n">supportsInterfaceID</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">((</span><span class="n">success</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="o">||</span><span class="p">(</span><span class="n">result</span><span class="o">==</span><span class="mi">0</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="p">(</span><span class="n">success</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span> <span class="o">=</span> <span class="n">noThrowCall</span><span class="p">(</span><span class="n">_contract</span><span class="p">,</span> <span class="n">InvalidID</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">((</span><span class="n">success</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="o">||</span><span class="p">(</span><span class="n">result</span><span class="o">!=</span><span class="mi">0</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="p">(</span><span class="n">success</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span> <span class="o">=</span> <span class="n">noThrowCall</span><span class="p">(</span><span class="n">_contract</span><span class="p">,</span> <span class="n">_interfaceId</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">((</span><span class="n">success</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="n">result</span><span class="o">==</span><span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">function</span> <span class="n">noThrowCall</span><span class="p">(</span><span class="kt">address</span> <span class="n">_contract</span><span class="p">,</span> <span class="kt">bytes4</span> <span class="n">_interfaceId</span><span class="p">)</span> <span class="k">constant</span> <span class="k">internal</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">uint256</span> <span class="n">success</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">bytes4</span> <span class="n">id</span> <span class="o">=</span> <span class="n">supportsInterfaceID</span><span class="p">;</span>

        <span class="k">assembly</span> <span class="p">{</span>
                <span class="kr">let</span> <span class="n">x</span> <span class="o">:=</span> <span class="n">mload</span><span class="p">(</span><span class="mh">0x40</span><span class="p">)</span>               <span class="c1">// Find empty storage location using "free memory pointer"
</span>                <span class="n">mstore</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">id</span><span class="p">)</span>                      <span class="c1">// Place signature at beginning of empty storage
</span>                <span class="n">mstore</span><span class="p">(</span><span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">),</span> <span class="n">_interfaceId</span><span class="p">)</span> <span class="c1">// Place first argument directly next to signature
</span>
                <span class="n">success</span> <span class="o">:=</span> <span class="n">staticcall</span><span class="p">(</span>
                                    <span class="mi">30000</span><span class="p">,</span>         <span class="c1">// 30k gas
</span>                                    <span class="n">_contract</span><span class="p">,</span>     <span class="c1">// To addr
</span>                                    <span class="n">x</span><span class="p">,</span>             <span class="c1">// Inputs are stored at location x
</span>                                    <span class="mh">0x24</span><span class="p">,</span>          <span class="c1">// Inputs are 36 bytes long
</span>                                    <span class="n">x</span><span class="p">,</span>             <span class="c1">// Store output over input (saves space)
</span>                                    <span class="mh">0x20</span><span class="p">)</span>          <span class="c1">// Outputs are 32 bytes long
</span>
                <span class="n">result</span> <span class="o">:=</span> <span class="n">mload</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>                 <span class="c1">// Load the result
</span>        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="implementation">Implementation</h2>

<p>This approach uses a <code class="language-plaintext highlighter-rouge">view</code> function implementation of <code class="language-plaintext highlighter-rouge">InterfaceIdentifier</code>. The execution cost is 586 gas for any input. But contract initialization requires storing each interface (<code class="language-plaintext highlighter-rouge">SSTORE</code> is 20,000 gas). The <code class="language-plaintext highlighter-rouge">MappingImplementation</code> contract is generic and reusable.</p>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">pragma</span> <span class="n">solidity</span> <span class="o">^</span><span class="mf">0.4</span><span class="p">.</span><span class="mi">24</span><span class="p">;</span>

<span class="k">import</span> <span class="s">"./InterfaceIdentifier.sol"</span><span class="p">;</span>

<span class="k">contract</span> <span class="n">MappingImplementation</span> <span class="k">is</span> <span class="n">InterfaceIdentifier</span> <span class="p">{</span>
    <span class="c1">/// @dev You must not set element 0xffffffff to true
</span>    <span class="k">mapping</span><span class="p">(</span><span class="kt">bytes4</span> <span class="o">=&gt;</span> <span class="kt">bool</span><span class="p">)</span> <span class="k">internal</span> <span class="n">supportedInterfaces</span><span class="p">;</span>

    <span class="k">function</span> <span class="n">MappingImplementation</span><span class="p">()</span> <span class="k">internal</span> <span class="p">{</span>
        <span class="n">supportedInterfaces</span><span class="p">[</span><span class="nb">this</span><span class="p">.</span><span class="n">supportsInterface</span><span class="p">.</span><span class="nb">selector</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">function</span> <span class="n">supportsInterface</span><span class="p">(</span><span class="kt">bytes4</span> <span class="n">interfaceID</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">supportedInterfaces</span><span class="p">[</span><span class="n">interfaceID</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">interface</span> <span class="n">Simpson</span> <span class="p">{</span>
    <span class="k">function</span> <span class="n">is2D</span><span class="p">()</span> <span class="k">external</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">);</span>
    <span class="k">function</span> <span class="n">skinColor</span><span class="p">()</span> <span class="k">external</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">string</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">contract</span> <span class="n">Lisa</span> <span class="k">is</span> <span class="n">MappingImplementation</span><span class="p">,</span> <span class="n">Simpson</span> <span class="p">{</span>
    <span class="k">function</span> <span class="n">Lisa</span><span class="p">()</span> <span class="k">public</span> <span class="p">{</span>
        <span class="n">supportedInterfaces</span><span class="p">[</span><span class="nb">this</span><span class="p">.</span><span class="n">is2D</span><span class="p">.</span><span class="nb">selector</span> <span class="o">^</span> <span class="nb">this</span><span class="p">.</span><span class="n">skinColor</span><span class="p">.</span><span class="nb">selector</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">function</span> <span class="n">is2D</span><span class="p">()</span> <span class="k">external</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">){}</span>
    <span class="k">function</span> <span class="n">skinColor</span><span class="p">()</span> <span class="k">external</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">string</span><span class="p">){}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Following is a <code class="language-plaintext highlighter-rouge">pure</code> function implementation of <code class="language-plaintext highlighter-rouge">InterfaceIdentifier</code>. The worst-case execution cost is 236 gas, but increases linearly with a higher number of supported interfaces.</p>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">pragma</span> <span class="n">solidity</span> <span class="o">^</span><span class="mf">0.4</span><span class="p">.</span><span class="mi">24</span><span class="p">;</span>

<span class="k">import</span> <span class="s">"./InterfaceIdentifier.sol"</span><span class="p">;</span>

<span class="k">interface</span> <span class="n">Simpson</span> <span class="p">{</span>
    <span class="k">function</span> <span class="n">is2D</span><span class="p">()</span> <span class="k">external</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">);</span>
    <span class="k">function</span> <span class="n">skinColor</span><span class="p">()</span> <span class="k">external</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">string</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">contract</span> <span class="n">Homer</span> <span class="k">is</span> <span class="n">InterfaceIdentifer</span><span class="p">,</span> <span class="n">Simpson</span> <span class="p">{</span>
    <span class="k">function</span> <span class="n">supportsInterface</span><span class="p">(</span><span class="kt">bytes4</span> <span class="n">interfaceID</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span>
          <span class="n">interfaceID</span> <span class="o">==</span> <span class="nb">this</span><span class="p">.</span><span class="n">supportsInterface</span><span class="p">.</span><span class="nb">selector</span> <span class="o">||</span> <span class="c1">// InterfaceIdentifier
</span>          <span class="n">interfaceID</span> <span class="o">==</span> <span class="nb">this</span><span class="p">.</span><span class="n">is2D</span><span class="p">.</span><span class="nb">selector</span>
                         <span class="o">^</span> <span class="nb">this</span><span class="p">.</span><span class="n">skinColor</span><span class="p">.</span><span class="nb">selector</span><span class="p">;</span> <span class="c1">// Simpson
</span>    <span class="p">}</span>

    <span class="k">function</span> <span class="n">is2D</span><span class="p">()</span> <span class="k">external</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">){}</span>
    <span class="k">function</span> <span class="n">skinColor</span><span class="p">()</span> <span class="k">external</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">string</span><span class="p">){}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>With three or more supported interfaces (including KIP-13 itself as a required supported interface), the mapping approach (in every case) costs less gas than the pure approach (at worst case).</p>

<h2 id="references">References</h2>
<ul>
  <li>https://eips.ethereum.org/EIPS/eip-165</li>
  <li>https://solidity.readthedocs.io/en/develop/abi-spec.html#function-selector</li>
</ul>

<h2 id="copyright">Copyright</h2>
<p>Copyright and related rights waived via <a href="https://creativecommons.org/publicdomain/zero/1.0/">CC0</a>.</p>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.2.3/mermaid.min.js" integrity="sha512-M4zmdILgXOwrBEVfpVqdO/jC3BJZQzlXHeu967v41/QoT60sESWSLbi7YwntTbYC0ZjewfTbvXO8iKj7amvQow==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>
  mermaid.initialize({
    startOnLoad: true,
  });
  mermaid.run({
    querySelector: '.language-mermaid', // markdown 'mermaid' language code blocks
  });
</script>


</div>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Kaia Improvement Proposals</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Kaia Improvement Proposals</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/kaiachain/KIPs"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">kaiachain/KIPs</span></a></li><li><a href="https://twitter.com/kaiachain"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">kaiachain</span></a></li><li><a href="https://www.facebook.com/kaiachain"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#facebook"></use></svg> <span class="username">kaiachain</span></a></li><li><a href="https://medium.com/kaiachain"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#medium"></use></svg> <span class="username">kaiachain</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Kaia Improvement Proposals (KIPs) describe standards for the Kaia platform, including core protocol specifications, client APIs, and contract standards.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
